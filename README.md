# Weather Data Pipeline & Dashboard

This project automates a weather data pipeline using **Apache Airflow** and visualizes the data with a **Streamlit** dashboard. It extracts weather forecasts from the OpenWeatherMap API, stores them in a PostgreSQL database using **SCD Type 2** for historical tracking, and provides an interactive dashboard for data exploration.

## Why This Project?
- **Airflow**: Automates and schedules data extraction, transformation, and loading (ETL).
- **SCD Type 2**: Preserves historical weather forecast changes for analytics and compliance.
- **Streamlit**: Offers an interactive dashboard to visualize weather trends and conditions.

## Architecture

OpenWeatherMap API → Airflow ETL → PostgreSQL (SCD Type 2) → Streamlit Dashboard

## Prerequisites
- Python 3.8+
- PostgreSQL(containerized)
- Docker
- OpenWeatherMap API key
- Airflow(conterized)
- Streamlit

## Setup Instructions

## 1. Install Dependencies
pip install pandas requests psycopg2-binary sqlalchemy python-dotenv apache-airflow streamlit

## 2. Configure EnvironmentCreate a .env file in the project root:env

OPENWEATHER_API_KEY=your_api_key
DB_USERNAME=your_db_username
DB_PASSWORD=your_db_password
DB_HOST=localhost
DB_PORT=5432
DB_NAME=weather_app
CITY=London

- The Airflow stack mounts `../.env` into the container at `/opt/airflow/.env`.

## 3. Run the Airflow stack
```bash
cd weather_airflow_docker
# Start services
docker compose up -d
# View web UI
open http://localhost:8081
```
- Airflow admin user/password are set in `docker-compose.yaml`.
- Postgres service is exposed on `localhost:5433` (see compose for creds).

4) Trigger pipelines
- In Airflow UI, unpause and trigger:
  - weather_pipeline_dag



## 4. Run the Streamlit Dashboardbash

streamlit run streamlit_weather.py

Access the dashboard at http://localhost:8501.

### Features
# Airflow
- Pipeline Extract: Fetches 5-day weather forecasts (3-hour intervals) from OpenWeatherMap API.
- Transform: structures weather data.
- Load: Stores data in PostgreSQL with SCD Type 2 for historical tracking.
- Benefits: Reliable automation, historical audit trail, and data versioning.

# Streamlit
- Dashboard Data View: Displays filtered weather data (datetime, temperature, conditions).
- Filters: Select date range and location (if available).
- Visualizations:Weather conditions with icons (e.g., Clear, Clouds, Rain).
- Temperature trends (line chart).

File: Requires weather_forecast_json.csv generated by the Airflow pipeline.

### Database Schema (SCD Type 2)- sql

 CREATE TABLE calgary_weather_data(
  id SERIAL PRIMARY KEY,
  datetime TIMESTAMP,
  temperature DECIMAL(5,2),
  conv_temp DECIMAL(5,2),
  weather_info JSONB NOT NULL,
  valid_from TIMESTAMP DEFAULT NOW(),
  valid_to TIMESTAMP,
  is_current BOOLEAN DEFAULT TRUE,
 UNIQUE(datetime, valid_from)
);

### Usage:
- Runthe Airflow pipeline to fetch and store weather data.
- Generate weather_forecast_json.csv from the PostgreSQL database.
- Launch the Streamlit dashboard to explore the data interactively.

### Contributing:
- Contributions are welcome! Focus areas:Performance optimization
- Additional weather APIs
- Enhanced dashboard features
- Data quality monitoring

### Future Enhancements
- Real-time data streaming with Apache Kafka
- Machine learning for forecast accuracy
- Multi-source data integration